%===============================================================================
% File Name     : amm-pst-certificate.sty
% Description   : Definitions Commands for Dolphin Certificate
%-------------------------------------------------------------------------------
% Author        : Amit Manohar Manthanwar
% Locale        : Pune, Maharashtra, India
% WebURL        : https://manthanwar.github.io
%-------------------------------------------------------------------------------
% Copyright     : Â©2025 Amit Manohar Manthanwar
% License       : LaTeX Project Public License
%-------------------------------------------------------------------------------
% This program can be redistributed and/or modified under the terms
% of the LaTeX Project Public License Distributed from CTAN archives
% in directory macros/latex/base/lppl.txt.
%===============================================================================
% Revision Log  | Author  | Description
%---------------+---------+----------------------------------------------------
% 20-Oct-2025   | AMM     | Initial Version
%---------------+---------+----------------------------------------------------
%===============================================================================
\NeedsTeXFormat{LaTeX2e}[2023-11-01]
\ProvidesPackage{amm-pst-certificate}[Version 20.10.2025 Postscript Marksheet Designs (c) Amit M. Manthanwar]
%===============================================================================

%===============================================================================
\def\decP{3}%
\newcommand{\fpEval}[1]{\fpeval{round(#1,\decP)}}%
%===============================================================================

%===============================================================================
% region color definitions
\newcommand{\defineColor}[1]{%[c68172]{%
\definecolor{orangeUniversityOfPune}{HTML}{#1}%
\def\certificateColor{orangeUniversityOfPune}%
}%
%-------------------------------------------------------------------------------
% \definecolor{orangeUniversityOfPune}{HTML}{c68172}%
% \definecolor{\certificateColor}{HTML}{994d3d}%
%-------------------------------------------------------------------------------
% endregion color definitions
%===============================================================================

%===============================================================================
% region \defineCertificate
% \def\certificateSchool{University Of Pune}%
% \def\certificateNumber{0020250808}%
% \def\certificateDate{1 August 2025}%
%-------------------------------------------------------------------------------
\newcommand{\defineCertificate}[3]{%
\def\certificateSchool{#1}%
\def\certificateNumber{#2}%
\def\certificateDate{#3}%
}%
% endregion \defineCertificate
%===============================================================================

%===============================================================================
% region define Student
% \def\studentNumber{A12345678}%
% \def\studentName{Title Name Middle Surname}%
%-------------------------------------------------------------------------------
% \newcommand{\studentTitle}[1]{\def\studentTitle{#1}}%
\newcommand{\studentTitle}[1]{\if\relax\detokenize{#1}\relax\def\studentTitle{}\else\def\studentTitle{#1\space}\fi}%
\newcommand{\studentNameF}[1]{\def\studentNameF{#1}}%
\newcommand{\studentNameM}[1]{\if\relax\detokenize{#1}\relax\def\studentNameM{}\else\def\studentNameM{#1\space}\fi}%
\newcommand{\studentNameL}[1]{\def\studentNameL{#1}}%
\newcommand{\studentIdNum}[1]{\def\studentNumber{#1}}%
\def\studentName{%
\studentTitle\studentNameF\space\studentNameM\studentNameL}%
%-------------------------------------------------------------------------------
% \studentTitle{Mr}%
% \studentNameF{Name}%
% \studentNameM{}%
% \studentNameL{Last}%
% \studentIdNum{A12345678}%
\newcommand{\defineStudent}[5]{%
\studentTitle{#1}%
\studentNameF{#2}%
\studentNameM{#3}%
\studentNameL{#4}%
\studentIdNum{#5}%
}%
%-------------------------------------------------------------------------------
% endregion define Student
%===============================================================================

%===============================================================================
% region \defExam???
%-------------------------------------------------------------------------------
% \def\certificateSchool{University Of Pune}%
% \def\certificateNumber{0020250808}%
% \def\certificateDate{1 August 2025}%
% \def\studentNumber{A12345678}%
% \def\studentName{Title Name Middle Surname}%
\def\examName{Bachelor of Computer Engineering}%
\def\examDate{May 2025}%
\def\examResult{First Class With Distinction}%
% endregion \defExam???
%===============================================================================

%===============================================================================
% region \defineExam
% \def\examName{Bachelor of Computer Engineering}%
% \def\examDate{May 2025}%
% \def\examResult{First Class With Distinction}%
\newcommand{\defineExam}[3]{%
\def\examName{#1}%
\def\examDate{#2}%
\def\examResult{#3}%
\makeCertificate%
}%
%-------------------------------------------------------------------------------
% endregion \defineExam
%===============================================================================

%===============================================================================
% region \removeSpaces
\newcommand{\removeSpaces}[1]{\begingroup\spaceskip=1sp
\xspaceskip=1sp #1\endgroup}%
% endregion \removeSpaces
%===============================================================================

%===============================================================================
% region \pageBackgroundText
% #1 : University of Pune
% #2 : how many times horizontal = 10
% #3 : how many times vertical = 95
% #4 : vertical gap factor = 0.7
% #5 : width = 280
% #6 : height = 190
\newcommand{\pageBackgroundText}[6]{%
\def\noH{\fpEval{#5/#2}}%
\def\noV{\fpEval{#6/#3}}%
\def\noVs{\fpEval{#4*#6/#3}}%
\multirput[lb](0,0)(0,\noV){#3}{%
\multirput[lb](0,0)(\noH,0){#2}{\resizebox{\noH mm}{\noVs mm}{\textcolor{\certificateColor!25}{\MakeUppercase{\removeSpaces{#1}}}}}}}%
%
% endregion \pageBackgroundText
%===============================================================================

%===============================================================================
% region \certificateSignature
\newcommand{\certificateSignature}{%
\rput[r](260,15){\color{\certificateColor}{\small{\textbf{\textsf{\uppercase{Controller of examination}}}}}}%
%
\rput(232,27){\psscalebox{1.5}{\psset{fillcolor=\certificateColor}\input{fig-signature.tex}}}%
}%
% endregion \certificateSignature
%===============================================================================


%==============================================================================
% region \makeCertificate
\newcommand{\makeCertificate}{%
\begin{figure}[!ht]
% \vspace*{-0.1mm}%
% \begin{center}
% \hspace*{-16.5mm}%
% \hspace*{-19.5mm}%
% \resizebox{1\textwidth}{!}{
% \resizebox{278.4mm}{!}{%
\resizebox{278.3mm}{189.9mm}{%
% \psset{unit=10mm}%\sffamily
% \begin{pspicture}(0,0)(29,21)
\begin{pspicture}(0,0)(28,19)
% \psgrid[subgriddiv=5, gridcolor=gray!50, subgridcolor=gray!20]%,griddots=4,subgriddots=10] %,gridlabels=8pt,gridlabelcolor=red]
%-------------------------------------------------------------------------------
% \rput(0,0){\testPageSize}%
\psset{unit=1mm,dimen=middle,linestyle=solid,fillstyle=none}%
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\certificateBorder%
%-------------------------------------------------------------------------------
% \rput[l](10,10){\resizebox{35mm}{!}{University of Pune}}%
\rput(0,0.4){\pageBackgroundText{\certificateSchool}{11}{90}{0.7}{280}{190}}%
%-------------------------------------------------------------------------------
\rput(140,175){\resizebox{!}{7mm}{\textcolor{\certificateColor}{\textbf{\MakeUppercase{\certificateSchool}}}}}%
%-------------------------------------------------------------------------------
\def\hspaceGap{\hspace{10mm}}%
\def\certFontSize{\large\textbf}%
%
\rput[lt](20,150){\color{\certificateColor}{\certFontSize{Number:}}\hspaceGap\color{black}{\certFontSize{\studentNumber}}}%
%
\rput[rt](260,150){\color{\certificateColor}{\certFontSize{Date:}}\hspaceGap\color{black}{\certFontSize{\MakeUppercase{\certificateDate}}}}%
%
\rput(145,130){\color{\certificateColor}{\certFontSize{This is to certify that}}}%
%
\rput[l](20,110){\color{\certificateColor}{\certFontSize{Mr/Ms}}\hspaceGap\color{black}{\certFontSize{\MakeUppercase{\studentName}}}}%
%
\rput[l](20,90){\color{\certificateColor}{\certFontSize{Passed the}}%
\hspaceGap\color{black}{\certFontSize{\MakeUppercase{\examName}}}%
\hspaceGap\color{\certificateColor}{\certFontSize{examination held by}}}%%
%
\rput[l](20,70){\color{\certificateColor}{\certFontSize{\certificateSchool\ in the month of}}\hspaceGap\color{black}{\certFontSize{\MakeUppercase{\examDate}}}}%
\rput[l](20,50){\color{\certificateColor}{\certFontSize{and was placed in}}
\hspaceGap\color{black}{\certFontSize{\MakeUppercase{\examResult}}}}%
%
\rput[l](20,15){\color{black}{\LARGE{\fontfamily{lmtt}\fontseries{b}\selectfont{\certificateNumber}}}}%
%-------------------------------------------------------------------------------
\certificateSignature%
%------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\end{pspicture}
}% \resizebox
% \caption{}
% \label{fig:}
% \end{center}
\end{figure}
% ps2pdf -dNOSAFER fileName.ps
}% end \newcommand{\makeCertificate}
% endregion \makeCertificate
%==============================================================================


%===============================================================================
%===============================================================================
%===============================================================================
%===============================================================================
%===============================================================================
%===============================================================================
%===============================================================================
%-------------------------------------------------------------------------------
\endinput
%% End of file
%===============================================================================
%===============================================================================
%===============================================================================

\newcommand{\iconWaterWheel}[1][]{\setkeys{\kvf}{#1}%
\FPeval{\wide}{round(\iconWidth/4:3)}\psscalebox{\wide}{%
\psset{linestyle=solid}%
\pscircle(0,0){2}%
}}% end \psscalebox % end \waterWheel
%-------------------------------------------------------------------------------
% \rput(2,2){\waterWheel[iconWidth=4,colorWheel=red]}
% \rput(2,2){\waterWheel}
% \rput(13,18.5){Cloths @ \number\inputlineno}
%===============================================================================
